<?xml version="1.0" encoding="UTF-8"?>
<report xmlns="http://www.eclipse.org/birt/2005/design" version="3.2.23" id="1">
    <property name="createdBy">Eclipse BIRT Designer Version 4.2.2.v201301041109 Build &lt;4.2.2.v20130114-2359></property>
    <list-property name="includeScripts">
        <property>js/common/report_tool.js</property>
    </list-property>
    <property name="units">in</property>
    <method name="initialize"><![CDATA[count = 0;
rowCount = 0;
pageBreak = 0;

isVisiualColorCountSum = 0;
isVisiualColorCount = 0;

initializeReport([]);

path = reportContext.getParameterValue("path");
if(path != "") {
   recordNum = recordNum * 2;
}
]]></method>
    <property name="iconFile">/templates/blank_report.gif</property>
    <property name="layoutPreference">auto layout</property>
    <property name="bidiLayoutOrientation">ltr</property>
    <property name="imageDPI">96</property>
    <parameters>
        <scalar-parameter name="ctx" id="462">
            <property name="valueType">static</property>
            <property name="isRequired">false</property>
            <property name="dataType">string</property>
            <property name="distinct">true</property>
            <simple-property-list name="defaultValue">
                <value type="constant"></value>
            </simple-property-list>
            <list-property name="selectionList"/>
            <property name="paramType">simple</property>
            <property name="controlType">text-box</property>
            <structure name="format">
                <property name="category">Unformatted</property>
            </structure>
        </scalar-parameter>
        <scalar-parameter name="monId" id="482">
            <property name="valueType">static</property>
            <property name="dataType">string</property>
            <property name="distinct">true</property>
            <list-property name="selectionList"/>
            <property name="paramType">simple</property>
            <property name="controlType">text-box</property>
            <structure name="format">
                <property name="category">Unformatted</property>
            </structure>
        </scalar-parameter>
        <scalar-parameter name="areaId" id="483">
            <property name="valueType">static</property>
            <property name="isRequired">false</property>
            <property name="dataType">string</property>
            <property name="distinct">true</property>
            <simple-property-list name="defaultValue">
                <value type="constant"></value>
            </simple-property-list>
            <list-property name="selectionList"/>
            <property name="paramType">simple</property>
            <property name="controlType">text-box</property>
            <structure name="format">
                <property name="category">Unformatted</property>
            </structure>
        </scalar-parameter>
        <scalar-parameter name="startDate" id="484">
            <property name="valueType">static</property>
            <property name="isRequired">false</property>
            <property name="dataType">string</property>
            <property name="distinct">true</property>
            <simple-property-list name="defaultValue">
                <value type="constant"></value>
            </simple-property-list>
            <list-property name="selectionList"/>
            <property name="paramType">simple</property>
            <property name="controlType">text-box</property>
            <structure name="format">
                <property name="category">Unformatted</property>
            </structure>
        </scalar-parameter>
        <scalar-parameter name="endDate" id="485">
            <property name="valueType">static</property>
            <property name="isRequired">false</property>
            <property name="dataType">string</property>
            <property name="distinct">true</property>
            <simple-property-list name="defaultValue">
                <value type="constant"></value>
            </simple-property-list>
            <list-property name="selectionList"/>
            <property name="paramType">simple</property>
            <property name="controlType">text-box</property>
            <structure name="format">
                <property name="category">Unformatted</property>
            </structure>
        </scalar-parameter>
        <scalar-parameter name="path" id="486">
            <property name="valueType">static</property>
            <property name="isRequired">false</property>
            <property name="dataType">string</property>
            <property name="distinct">true</property>
            <simple-property-list name="defaultValue">
                <value type="constant"></value>
            </simple-property-list>
            <list-property name="selectionList"/>
            <property name="paramType">simple</property>
            <property name="controlType">text-box</property>
            <structure name="format">
                <property name="category">Unformatted</property>
            </structure>
        </scalar-parameter>
        <scalar-parameter name="isVisualArea" id="491">
            <property name="valueType">static</property>
            <property name="isRequired">false</property>
            <property name="dataType">string</property>
            <property name="distinct">true</property>
            <simple-property-list name="defaultValue">
                <value type="constant"></value>
            </simple-property-list>
            <list-property name="selectionList"/>
            <property name="paramType">simple</property>
            <property name="controlType">text-box</property>
            <structure name="format">
                <property name="category">Unformatted</property>
            </structure>
        </scalar-parameter>
        <scalar-parameter name="areaGroupName" id="493">
            <property name="valueType">static</property>
            <property name="isRequired">false</property>
            <property name="dataType">string</property>
            <property name="distinct">true</property>
            <simple-property-list name="defaultValue">
                <value type="constant"></value>
            </simple-property-list>
            <list-property name="selectionList"/>
            <property name="paramType">simple</property>
            <property name="controlType">text-box</property>
            <structure name="format">
                <property name="category">Unformatted</property>
            </structure>
        </scalar-parameter>
        <scalar-parameter name="recordNum" id="520">
            <property name="valueType">static</property>
            <property name="isRequired">false</property>
            <property name="dataType">string</property>
            <property name="distinct">true</property>
            <simple-property-list name="defaultValue">
                <value type="constant"></value>
            </simple-property-list>
            <list-property name="selectionList"/>
            <property name="paramType">simple</property>
            <property name="controlType">text-box</property>
            <structure name="format">
                <property name="category">Unformatted</property>
            </structure>
        </scalar-parameter>
        <scalar-parameter name="areaIds" id="521">
            <property name="valueType">static</property>
            <property name="isRequired">false</property>
            <property name="dataType">string</property>
            <property name="distinct">true</property>
            <simple-property-list name="defaultValue">
                <value type="constant"></value>
            </simple-property-list>
            <list-property name="selectionList"/>
            <property name="paramType">simple</property>
            <property name="controlType">text-box</property>
            <structure name="format">
                <property name="category">Unformatted</property>
            </structure>
        </scalar-parameter>
        <scalar-parameter name="monName" id="569">
            <property name="valueType">static</property>
            <property name="isRequired">false</property>
            <property name="dataType">string</property>
            <property name="distinct">true</property>
            <simple-property-list name="defaultValue">
                <value type="constant"></value>
            </simple-property-list>
            <list-property name="selectionList"/>
            <property name="paramType">simple</property>
            <property name="controlType">text-box</property>
            <structure name="format">
                <property name="category">Unformatted</property>
            </structure>
        </scalar-parameter>
    </parameters>
    <data-sources>
        <oda-data-source extensionID="org.eclipse.birt.report.data.oda.jdbc" name="Data Source" id="7">
            <method name="beforeOpen"><![CDATA[initializeDb(reportContext, extensionProperties);
]]></method>
            <list-property name="privateDriverProperties">
                <ex-property>
                    <name>metadataBidiFormatStr</name>
                    <value>ILYNN</value>
                </ex-property>
                <ex-property>
                    <name>disabledMetadataBidiFormatStr</name>
                </ex-property>
                <ex-property>
                    <name>contentBidiFormatStr</name>
                    <value>ILYNN</value>
                </ex-property>
                <ex-property>
                    <name>disabledContentBidiFormatStr</name>
                </ex-property>
            </list-property>
            <property name="odaDriverClass">com.mysql.jdbc.Driver</property>
            <property name="odaURL">jdbc:mysql://192.168.16.241/microlens_1112?useUnicode=true&amp;characterEncoding=utf-8</property>
            <property name="odaUser">root</property>
            <encrypted-property name="odaPassword" encryptionID="base64">bWljcm9sZW5z</encrypted-property>
        </oda-data-source>
    </data-sources>
    <data-sets>
        <oda-data-set extensionID="org.eclipse.birt.report.data.oda.jdbc.JdbcSelectDataSet" name="Data Set" id="8">
            <property name="nullsOrdering">nulls lowest</property>
            <list-property name="columnHints"/>
            <list-property name="parameters"/>
            <structure name="cachedMetaData"/>
            <method name="beforeOpen"><![CDATA[sqlStr = this.queryText;
monId = reportContext.getParameterValue("monId");
areaId = reportContext.getParameterValue("areaId");
areaIds = reportContext.getParameterValue("areaIds");
startDate = reportContext.getParameterValue("startDate");
endDate = reportContext.getParameterValue("endDate");
path = reportContext.getParameterValue("path");
isVisualArea = reportContext.getParameterValue("isVisualArea");

paramStr = "";

if(monId != null &amp;&amp; monId != "") {
  paramStr = " mon_id = " + monId;
}

if(path != null &amp;&amp; path != "" &amp;&amp; path != "*") {
   paramStr += " and path = " + path;
}

if(areaId != null &amp;&amp; areaId != "") {
   if(isVisualArea != null &amp;&amp; isVisualArea == "1") {
      paramStr += " and area_type = " + areaId;
   } 
}

if(areaIds != null &amp;&amp; areaIds != "") {
    paramStr += " and area_id in (" + areaIds + ")";
}

if(isVisualArea == null || isVisualArea == "") {
   paramStr += " and (area_type is NULL OR area_type = 'area' OR area_type = 'group') ";
}

if(startDate != null &amp;&amp; startDate != "") {
  paramStr += " and mon_date >= '" + startDate + "' ";
}

if(endDate != null &amp;&amp; endDate != "") {
  paramStr += " and mon_date <= '" + endDate + "' ";
}

if(paramStr == "") {
   paramStr = " 1 = 1 ";
}

text = new java.lang.String(sqlStr);
text = text.replaceAll("#condition#", paramStr);
this.queryText = text; 


]]></method>
            <property name="dataSource">Data Source</property>
            <list-property name="resultSet"/>
            <xml-property name="queryText"><![CDATA[SELECT
    *
FROM
    (
        SELECT
            CONCAT(monId, monDate, areaId) AS groupMark,
            monId,
            d. NAME AS areaName,
            monDate,
            areaId,
            m.area_type,
            path,
            sum(impLimit) AS impLimit,
						sum(planImp) as planImp,
            sum(impFwd) AS impFwd,
            impRate,
            impPercent,
            sum(clkFwd) AS clkFwd,
            sum(clkRateLimit) AS clkRateLimit,
					 sum(planClk) as planClk,
            clkRate,
            sum(actImp) AS actImp,
            sum(impBlock) AS impBlock,
            sum(impChokeSum) AS impChoke,
            sum(actClk) AS actClk,
            sum(clkBlock) AS clkBlock,
            sum(clkChokeSum) AS clkChoke,
            sum(impChokeArea) AS impChokeArea,
            sum(clkChokeArea) AS clkChokeArea
        FROM
            (
                SELECT
                    s.path,
                    s.monId,
                    s.monDate,
                    s.areaId,
                    s.area_type,
                    sum(
                        CASE
                        WHEN is_main_subpath = 1 THEN
                            s.impFwd
                        END
                    ) AS impFwd,
                    s.impLimit,
										s.planImp,
                    sum(
                        CASE
                        WHEN is_main_subpath = 1 THEN
                            s.actImp
                        END
                    ) AS actImp,
                    SUM(
                        CASE
                        WHEN is_main_subpath = 1 THEN
                            impBlock
                        END
                    ) impBlock,
                    '' AS impRate,
                    GROUP_CONCAT(
                        s.impFwd
                    ) AS impPercent,
                    '' AS clkRateLimit,
										'' as planClk,
                    '' AS clkRate,
                    '' AS clkFwd,
                    '' AS actClk,
                    '' AS clkBlock,
                    '' AS impChokeSum,
                    '' AS clkChokeSum,
                    '' AS impChokeArea,
                    '' AS clkChokeArea 
                FROM
                    (
                        SELECT
                            imp.path,
                            imp.mon_id AS monId,
                            imp.mon_date AS monDate,
                            imp.area_id AS areaId,
                            imp.area_type,
                            imp.sub_path,
                            SUM(imp_fwd) AS impFwd,
                            imp_limit AS impLimit,
                            plan_imp as planImp,
                            SUM(act_imp) AS actImp,
                            SUM(imp_block) AS impBlock,
                            is_main_subpath
                        FROM
                            stg_mc_imp_d imp
                        WHERE
                             #condition#
                        AND path IS NOT NULL
                        GROUP BY
                            imp.mon_id,
                            imp.mon_date,
                            imp.area_type,
                            imp.area_id,           
                            imp.path,
                            imp.sub_path
                    ) s
                GROUP BY
                    s.monId,
                    s.monDate,
                    s.areaId,
                    s.path
                UNION
                    SELECT
                        clk.path,
                        clk.mon_id AS monId,
                        clk.mon_date AS monDate,
                        clk.area_id AS areaId,
                        clk.area_type,
                        '' AS impFwd,
												'' AS planImp,
                        '' AS impLimit,
                        '' AS actImp,
                        '' AS impBlock,
                        '' AS impRate,
                        '' AS impPercent,
                        clk.clkrate_ctrl AS clkRateLimit,
                        plan_clk as planClk,
                        '' AS clkRate,
                        SUM(clk_fwd) AS clkFwd,
                        sum(act_clk) actClk,
                        SUM(clk_block) AS clkBlock,
                        '' AS impChokeSum,
                        '' AS clkChokeSum,
                        '' AS impChokeArea,
                        '' AS clkChokeArea 
                    FROM
                        stg_mc_clk_d clk
                    WHERE
                        #condition#
                    AND path IS NOT NULL
                    GROUP BY
                        clk.mon_id,
                        clk.mon_date,
                        clk.area_id,
                        clk.area_type,
                        clk.path
                UNION
                    SELECT
                        path,
                        mon_id AS monId,
                        mon_date AS monDate,
                        area_id AS areaId,
                        area_type,
                        '' AS impFwd,
                        '' AS impLimit,
												'' AS planImp,
                        '' AS actImp,
                        '' AS impBlock,
                        '' AS impRate,
                        '' AS impPercent,
                        '' AS clkRateLimit,
												'' as planClk,
                        '' AS clkRate,
                        '' AS clkFwd,
                        '' AS actClk,
                        '' AS clkBlock,
                        sum(choke_sum) AS impChokeSum,
                        '' AS clkChokeSum,
                        '' AS impChokeArea,
                        '' AS clkChokeArea 
                    FROM
                        stg_mc_imp_choke_d choke
                    WHERE
                        #condition#
                     AND is_main_subpath = 1 
                    AND path IS NOT NULL
                    GROUP BY
                        mon_id,
                        mon_date,
                        area_type,
                        area_id,
                        path
                UNION
                    SELECT
                        path,
                        mon_id AS monId,
                        mon_date AS monDate,
                        area_id AS areaId,
                        area_type,
                        '' AS impFwd,
                        '' AS impLimit,
												'' AS planImp,
                        '' AS actImp,
                        '' AS impBlock,
                        '' AS impRate,
                        '' AS impPercent,
                        '' AS clkRateLimit,
												'' as planClk,
                        '' AS clkRate,
                        '' AS clkFwd,
                        '' AS actClk,
                        '' AS clkBlock,
                        '' AS impChokeSum,
                        sum(choke_sum) AS clkChokeSum,
                        '' AS impChokeArea,
                        '' AS clkChokeArea 
                    FROM
                        stg_mc_clk_choke_d choke
                    WHERE
                         #condition#
                    AND path IS NOT NULL     
                    GROUP BY
                        mon_id,
                        mon_date,
                        area_type,
                        area_id,
                        path
                UNION
                    SELECT
                        path,
                        mon_id AS monId,
                        mon_date AS monDate,
                        area_id AS areaId,
                        area_type,
                        '' AS impFwd,
                        '' AS impLimit,
												'' AS planImp,
                        '' AS actImp,
                        '' AS impBlock,
                        '' AS impRate,
                        '' AS impPercent,
                        '' AS clkRateLimit,
												'' as planClk,
                        '' AS clkRate,
                        '' AS clkFwd,
                        '' AS actClk,
                        '' AS clkBlock,
                        '' AS impChokeSum,
                        '' AS clkChokeSum,
                        sum(choke_sum) AS impChokeArea,
                        '' AS clkChokeArea 
                    FROM
                        stg_mc_imp_choke_d imp_choke_area
                    WHERE
                         #condition#
                    AND choke_type_id = '2'
                    AND is_main_subpath = 1
                    AND path IS NOT NULL
                    GROUP BY
                        mon_id,
                        mon_date,
                        area_type,
                        area_id,
                        path
                UNION
                    SELECT
                        path,
                        mon_id AS monId,
                        mon_date AS monDate,
                        area_id AS areaId,
                        area_type,
                        '' AS impFwd,
                        '' AS impLimit,
												'' AS planImp,
                        '' AS actImp,
                        '' AS impBlock,
                        '' AS impRate,
                        '' AS impPercent,
                        '' AS clkRateLimit,
												'' as planClk,
                        '' AS clkRate,
                        '' AS clkFwd,
                        '' AS actClk,
                        '' AS clkBlock,
                        '' AS impChokeSum,
                        '' AS clkChokeSum,
                        '' AS impChokeArea,
                        sum(choke_sum) AS clkChokeArea
                    FROM
                        stg_mc_clk_choke_d clk_choke_area
                    WHERE
                        #condition#
                    AND choke_type_id = '2' 
                    AND path IS NOT NULL
                    GROUP BY
                        mon_id,
                        mon_date,
                        area_type,
                        area_id,
                        path
            ) m
        LEFT JOIN dim_area d ON m.areaId = d.id LEFT JOIN mc_detail md ON m.monId = md.mc_id AND m.areaId = md.area_id
        GROUP BY
            m.monId,
            m.monDate,
            m.areaId,
            m.path
        ORDER BY
            md.sn ASC,
            CONVERT (d.NAME USING gbk) ASC,
            m.monDate DESC,
            m.path ASC
    ) s]]></xml-property>
            <xml-property name="designerValues"><![CDATA[<?xml version="1.0" encoding="UTF-8"?>
<model:DesignValues xmlns:design="http://www.eclipse.org/datatools/connectivity/oda/design" xmlns:model="http://www.eclipse.org/birt/report/model/adapter/odaModel">
  <Version>2.0</Version>
  <design:ResultSets derivedMetaData="true">
    <design:resultSetDefinitions>
      <design:resultSetColumns>
        <design:resultColumnDefinitions>
          <design:attributes>
            <design:identifier>
              <design:name>groupMark</design:name>
              <design:position>1</design:position>
            </design:identifier>
            <design:nativeDataTypeCode>12</design:nativeDataTypeCode>
            <design:precision>32</design:precision>
            <design:scale>0</design:scale>
            <design:nullability>Nullable</design:nullability>
            <design:uiHints>
              <design:displayName>groupMark</design:displayName>
            </design:uiHints>
          </design:attributes>
          <design:usageHints>
            <design:label>groupMark</design:label>
            <design:formattingHints>
              <design:displaySize>32</design:displaySize>
            </design:formattingHints>
          </design:usageHints>
        </design:resultColumnDefinitions>
        <design:resultColumnDefinitions>
          <design:attributes>
            <design:identifier>
              <design:name>monId</design:name>
              <design:position>2</design:position>
            </design:identifier>
            <design:nativeDataTypeCode>4</design:nativeDataTypeCode>
            <design:precision>11</design:precision>
            <design:scale>0</design:scale>
            <design:nullability>Nullable</design:nullability>
            <design:uiHints>
              <design:displayName>monId</design:displayName>
            </design:uiHints>
          </design:attributes>
          <design:usageHints>
            <design:label>monId</design:label>
            <design:formattingHints>
              <design:displaySize>11</design:displaySize>
            </design:formattingHints>
          </design:usageHints>
        </design:resultColumnDefinitions>
        <design:resultColumnDefinitions>
          <design:attributes>
            <design:identifier>
              <design:name>monDate</design:name>
              <design:position>3</design:position>
            </design:identifier>
            <design:nativeDataTypeCode>91</design:nativeDataTypeCode>
            <design:precision>10</design:precision>
            <design:scale>0</design:scale>
            <design:nullability>Nullable</design:nullability>
            <design:uiHints>
              <design:displayName>monDate</design:displayName>
            </design:uiHints>
          </design:attributes>
          <design:usageHints>
            <design:label>monDate</design:label>
            <design:formattingHints>
              <design:displaySize>10</design:displaySize>
            </design:formattingHints>
          </design:usageHints>
        </design:resultColumnDefinitions>
        <design:resultColumnDefinitions>
          <design:attributes>
            <design:identifier>
              <design:name>areaId</design:name>
              <design:position>4</design:position>
            </design:identifier>
            <design:nativeDataTypeCode>12</design:nativeDataTypeCode>
            <design:precision>11</design:precision>
            <design:scale>0</design:scale>
            <design:nullability>Nullable</design:nullability>
            <design:uiHints>
              <design:displayName>areaId</design:displayName>
            </design:uiHints>
          </design:attributes>
          <design:usageHints>
            <design:label>areaId</design:label>
            <design:formattingHints>
              <design:displaySize>11</design:displaySize>
            </design:formattingHints>
          </design:usageHints>
        </design:resultColumnDefinitions>
        <design:resultColumnDefinitions>
          <design:attributes>
            <design:identifier>
              <design:name>areaName</design:name>
              <design:position>5</design:position>
            </design:identifier>
            <design:nativeDataTypeCode>12</design:nativeDataTypeCode>
            <design:precision>20</design:precision>
            <design:scale>0</design:scale>
            <design:nullability>Nullable</design:nullability>
            <design:uiHints>
              <design:displayName>areaName</design:displayName>
            </design:uiHints>
          </design:attributes>
          <design:usageHints>
            <design:label>areaName</design:label>
            <design:formattingHints>
              <design:displaySize>20</design:displaySize>
            </design:formattingHints>
          </design:usageHints>
        </design:resultColumnDefinitions>
        <design:resultColumnDefinitions>
          <design:attributes>
            <design:identifier>
              <design:name>path</design:name>
              <design:position>6</design:position>
            </design:identifier>
            <design:nativeDataTypeCode>4</design:nativeDataTypeCode>
            <design:precision>11</design:precision>
            <design:scale>0</design:scale>
            <design:nullability>Nullable</design:nullability>
            <design:uiHints>
              <design:displayName>path</design:displayName>
            </design:uiHints>
          </design:attributes>
          <design:usageHints>
            <design:label>path</design:label>
            <design:formattingHints>
              <design:displaySize>11</design:displaySize>
            </design:formattingHints>
          </design:usageHints>
        </design:resultColumnDefinitions>
        <design:resultColumnDefinitions>
          <design:attributes>
            <design:identifier>
              <design:name>impFwd</design:name>
              <design:position>7</design:position>
            </design:identifier>
            <design:nativeDataTypeCode>8</design:nativeDataTypeCode>
            <design:precision>23</design:precision>
            <design:scale>31</design:scale>
            <design:nullability>Nullable</design:nullability>
            <design:uiHints>
              <design:displayName>impFwd</design:displayName>
            </design:uiHints>
          </design:attributes>
          <design:usageHints>
            <design:label>impFwd</design:label>
            <design:formattingHints>
              <design:displaySize>23</design:displaySize>
            </design:formattingHints>
          </design:usageHints>
        </design:resultColumnDefinitions>
        <design:resultColumnDefinitions>
          <design:attributes>
            <design:identifier>
              <design:name>impLimit</design:name>
              <design:position>8</design:position>
            </design:identifier>
            <design:nativeDataTypeCode>8</design:nativeDataTypeCode>
            <design:precision>23</design:precision>
            <design:scale>31</design:scale>
            <design:nullability>Nullable</design:nullability>
            <design:uiHints>
              <design:displayName>impLimit</design:displayName>
            </design:uiHints>
          </design:attributes>
          <design:usageHints>
            <design:label>impLimit</design:label>
            <design:formattingHints>
              <design:displaySize>23</design:displaySize>
            </design:formattingHints>
          </design:usageHints>
        </design:resultColumnDefinitions>
        <design:resultColumnDefinitions>
          <design:attributes>
            <design:identifier>
              <design:name>actImp</design:name>
              <design:position>9</design:position>
            </design:identifier>
            <design:nativeDataTypeCode>8</design:nativeDataTypeCode>
            <design:precision>23</design:precision>
            <design:scale>31</design:scale>
            <design:nullability>Nullable</design:nullability>
            <design:uiHints>
              <design:displayName>actImp</design:displayName>
            </design:uiHints>
          </design:attributes>
          <design:usageHints>
            <design:label>actImp</design:label>
            <design:formattingHints>
              <design:displaySize>23</design:displaySize>
            </design:formattingHints>
          </design:usageHints>
        </design:resultColumnDefinitions>
        <design:resultColumnDefinitions>
          <design:attributes>
            <design:identifier>
              <design:name>impBlock</design:name>
              <design:position>10</design:position>
            </design:identifier>
            <design:nativeDataTypeCode>8</design:nativeDataTypeCode>
            <design:precision>23</design:precision>
            <design:scale>31</design:scale>
            <design:nullability>Nullable</design:nullability>
            <design:uiHints>
              <design:displayName>impBlock</design:displayName>
            </design:uiHints>
          </design:attributes>
          <design:usageHints>
            <design:label>impBlock</design:label>
            <design:formattingHints>
              <design:displaySize>23</design:displaySize>
            </design:formattingHints>
          </design:usageHints>
        </design:resultColumnDefinitions>
        <design:resultColumnDefinitions>
          <design:attributes>
            <design:identifier>
              <design:name>impRate</design:name>
              <design:position>11</design:position>
            </design:identifier>
            <design:nativeDataTypeCode>12</design:nativeDataTypeCode>
            <design:precision>0</design:precision>
            <design:scale>0</design:scale>
            <design:nullability>NotNullable</design:nullability>
            <design:uiHints>
              <design:displayName>impRate</design:displayName>
            </design:uiHints>
          </design:attributes>
          <design:usageHints>
            <design:label>impRate</design:label>
            <design:formattingHints>
              <design:displaySize>0</design:displaySize>
            </design:formattingHints>
          </design:usageHints>
        </design:resultColumnDefinitions>
        <design:resultColumnDefinitions>
          <design:attributes>
            <design:identifier>
              <design:name>impPercent</design:name>
              <design:position>12</design:position>
            </design:identifier>
            <design:nativeDataTypeCode>12</design:nativeDataTypeCode>
            <design:precision>34133</design:precision>
            <design:scale>0</design:scale>
            <design:nullability>Nullable</design:nullability>
            <design:uiHints>
              <design:displayName>impPercent</design:displayName>
            </design:uiHints>
          </design:attributes>
          <design:usageHints>
            <design:label>impPercent</design:label>
            <design:formattingHints>
              <design:displaySize>34133</design:displaySize>
            </design:formattingHints>
          </design:usageHints>
        </design:resultColumnDefinitions>
        <design:resultColumnDefinitions>
          <design:attributes>
            <design:identifier>
              <design:name>clkRateLimit</design:name>
              <design:position>13</design:position>
            </design:identifier>
            <design:nativeDataTypeCode>8</design:nativeDataTypeCode>
            <design:precision>23</design:precision>
            <design:scale>31</design:scale>
            <design:nullability>Nullable</design:nullability>
            <design:uiHints>
              <design:displayName>clkRateLimit</design:displayName>
            </design:uiHints>
          </design:attributes>
          <design:usageHints>
            <design:label>clkRateLimit</design:label>
            <design:formattingHints>
              <design:displaySize>23</design:displaySize>
            </design:formattingHints>
          </design:usageHints>
        </design:resultColumnDefinitions>
        <design:resultColumnDefinitions>
          <design:attributes>
            <design:identifier>
              <design:name>clkRate</design:name>
              <design:position>14</design:position>
            </design:identifier>
            <design:nativeDataTypeCode>12</design:nativeDataTypeCode>
            <design:precision>0</design:precision>
            <design:scale>0</design:scale>
            <design:nullability>NotNullable</design:nullability>
            <design:uiHints>
              <design:displayName>clkRate</design:displayName>
            </design:uiHints>
          </design:attributes>
          <design:usageHints>
            <design:label>clkRate</design:label>
            <design:formattingHints>
              <design:displaySize>0</design:displaySize>
            </design:formattingHints>
          </design:usageHints>
        </design:resultColumnDefinitions>
        <design:resultColumnDefinitions>
          <design:attributes>
            <design:identifier>
              <design:name>clkFwd</design:name>
              <design:position>15</design:position>
            </design:identifier>
            <design:nativeDataTypeCode>8</design:nativeDataTypeCode>
            <design:precision>23</design:precision>
            <design:scale>31</design:scale>
            <design:nullability>Nullable</design:nullability>
            <design:uiHints>
              <design:displayName>clkFwd</design:displayName>
            </design:uiHints>
          </design:attributes>
          <design:usageHints>
            <design:label>clkFwd</design:label>
            <design:formattingHints>
              <design:displaySize>23</design:displaySize>
            </design:formattingHints>
          </design:usageHints>
        </design:resultColumnDefinitions>
        <design:resultColumnDefinitions>
          <design:attributes>
            <design:identifier>
              <design:name>actClk</design:name>
              <design:position>16</design:position>
            </design:identifier>
            <design:nativeDataTypeCode>8</design:nativeDataTypeCode>
            <design:precision>23</design:precision>
            <design:scale>31</design:scale>
            <design:nullability>Nullable</design:nullability>
            <design:uiHints>
              <design:displayName>actClk</design:displayName>
            </design:uiHints>
          </design:attributes>
          <design:usageHints>
            <design:label>actClk</design:label>
            <design:formattingHints>
              <design:displaySize>23</design:displaySize>
            </design:formattingHints>
          </design:usageHints>
        </design:resultColumnDefinitions>
        <design:resultColumnDefinitions>
          <design:attributes>
            <design:identifier>
              <design:name>clkBlock</design:name>
              <design:position>17</design:position>
            </design:identifier>
            <design:nativeDataTypeCode>8</design:nativeDataTypeCode>
            <design:precision>23</design:precision>
            <design:scale>31</design:scale>
            <design:nullability>Nullable</design:nullability>
            <design:uiHints>
              <design:displayName>clkBlock</design:displayName>
            </design:uiHints>
          </design:attributes>
          <design:usageHints>
            <design:label>clkBlock</design:label>
            <design:formattingHints>
              <design:displaySize>23</design:displaySize>
            </design:formattingHints>
          </design:usageHints>
        </design:resultColumnDefinitions>
        <design:resultColumnDefinitions>
          <design:attributes>
            <design:identifier>
              <design:name>impChokeSum</design:name>
              <design:position>18</design:position>
            </design:identifier>
            <design:nativeDataTypeCode>8</design:nativeDataTypeCode>
            <design:precision>23</design:precision>
            <design:scale>31</design:scale>
            <design:nullability>Nullable</design:nullability>
            <design:uiHints>
              <design:displayName>impChokeSum</design:displayName>
            </design:uiHints>
          </design:attributes>
          <design:usageHints>
            <design:label>impChokeSum</design:label>
            <design:formattingHints>
              <design:displaySize>23</design:displaySize>
            </design:formattingHints>
          </design:usageHints>
        </design:resultColumnDefinitions>
        <design:resultColumnDefinitions>
          <design:attributes>
            <design:identifier>
              <design:name>clkChokeSum</design:name>
              <design:position>19</design:position>
            </design:identifier>
            <design:nativeDataTypeCode>8</design:nativeDataTypeCode>
            <design:precision>23</design:precision>
            <design:scale>31</design:scale>
            <design:nullability>Nullable</design:nullability>
            <design:uiHints>
              <design:displayName>clkChokeSum</design:displayName>
            </design:uiHints>
          </design:attributes>
          <design:usageHints>
            <design:label>clkChokeSum</design:label>
            <design:formattingHints>
              <design:displaySize>23</design:displaySize>
            </design:formattingHints>
          </design:usageHints>
        </design:resultColumnDefinitions>
      </design:resultSetColumns>
      <design:criteria/>
    </design:resultSetDefinitions>
  </design:ResultSets>
</model:DesignValues>]]></xml-property>
        </oda-data-set>
    </data-sets>
    <styles>
        <style name="report" id="4">
            <property name="fontFamily">sans-serif</property>
            <property name="fontSize">10pt</property>
        </style>
        <style name="crosstab-cell" id="5">
            <property name="borderBottomColor">#CCCCCC</property>
            <property name="borderBottomStyle">solid</property>
            <property name="borderBottomWidth">1pt</property>
            <property name="borderLeftColor">#CCCCCC</property>
            <property name="borderLeftStyle">solid</property>
            <property name="borderLeftWidth">1pt</property>
            <property name="borderRightColor">#CCCCCC</property>
            <property name="borderRightStyle">solid</property>
            <property name="borderRightWidth">1pt</property>
            <property name="borderTopColor">#CCCCCC</property>
            <property name="borderTopStyle">solid</property>
            <property name="borderTopWidth">1pt</property>
        </style>
        <style name="crosstab" id="6">
            <property name="borderBottomColor">#CCCCCC</property>
            <property name="borderBottomStyle">solid</property>
            <property name="borderBottomWidth">1pt</property>
            <property name="borderLeftColor">#CCCCCC</property>
            <property name="borderLeftStyle">solid</property>
            <property name="borderLeftWidth">1pt</property>
            <property name="borderRightColor">#CCCCCC</property>
            <property name="borderRightStyle">solid</property>
            <property name="borderRightWidth">1pt</property>
            <property name="borderTopColor">#CCCCCC</property>
            <property name="borderTopStyle">solid</property>
            <property name="borderTopWidth">1pt</property>
        </style>
    </styles>
    <page-setup>
        <simple-master-page name="Simple MasterPage" id="2"/>
    </page-setup>
    <body>
        <text-data id="568">
            <method name="onRender"><![CDATA[start_date = reportContext.getHttpServletRequest().getParameter("startDate");
end_date = reportContext.getHttpServletRequest().getParameter("endDate");
mc_name = reportContext.getHttpServletRequest().getParameter("monName");

myDate = new Date();
month = (((myDate.getMonth()+1) < 10) ? "-0" : "-") + (myDate.getMonth()+1);
day= ((myDate.getDate() < 10) ? "-0" : "-") + myDate.getDate();
currentDate = myDate.getFullYear() + month + day;
prefix = "Microlens.funshion.com" + " 播控-播放点击日期报告--分天";
period = start_date + " 至 " + end_date
display_text = prefix +"<br/>"+"导出报表日期："+currentDate+ "<br/>"+"报表类型：播控报表"+"<br/>"+"播控名称："+mc_name+"<br/>"+"报表时段："+period ;

format = reportContext.getHttpServletRequest().getParameter("__format");
if(format == "xls") {
   this.getStyle().display = "block";
   this.text= display_text;
} else {
   this.getStyle().display = "none";
}]]></method>
            <expression name="valueExpr">1</expression>
            <property name="contentType">html</property>
        </text-data>
        <table name="table" id="245">
            <property name="textAlign">center</property>
            <property name="width">100%</property>
            <property name="dataSet">Data Set</property>
            <list-property name="boundDataColumns">
                <structure>
                    <property name="name">groupMark</property>
                    <text-property name="displayName">groupMark</text-property>
                    <expression name="expression" type="javascript">dataSetRow["groupMark"]</expression>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="name">monId</property>
                    <text-property name="displayName">monId</text-property>
                    <expression name="expression" type="javascript">dataSetRow["monId"]</expression>
                    <property name="dataType">integer</property>
                </structure>
                <structure>
                    <property name="name">areaName</property>
                    <text-property name="displayName">areaName</text-property>
                    <expression name="expression" type="javascript">dataSetRow["areaName"]</expression>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="name">monDate</property>
                    <text-property name="displayName">monDate</text-property>
                    <expression name="expression" type="javascript">dataSetRow["monDate"]</expression>
                    <property name="dataType">date</property>
                </structure>
                <structure>
                    <property name="name">areaId</property>
                    <text-property name="displayName">areaId</text-property>
                    <expression name="expression" type="javascript">dataSetRow["areaId"]</expression>
                    <property name="dataType">integer</property>
                    <property name="allowExport">true</property>
                </structure>
                <structure>
                    <property name="name">path</property>
                    <text-property name="displayName">path</text-property>
                    <expression name="expression" type="javascript">dataSetRow["path"]</expression>
                    <property name="dataType">integer</property>
                </structure>
                <structure>
                    <property name="name">impLimit</property>
                    <text-property name="displayName">impLimit</text-property>
                    <expression name="expression" type="javascript">dataSetRow["impLimit"]</expression>
                    <property name="dataType">float</property>
                </structure>
                <structure>
                    <property name="name">impFwd</property>
                    <text-property name="displayName">impFwd</text-property>
                    <expression name="expression" type="javascript">dataSetRow["impFwd"]</expression>
                    <property name="dataType">float</property>
                </structure>
                <structure>
                    <property name="name">impRate</property>
                    <text-property name="displayName">impRate</text-property>
                    <expression name="expression" type="javascript">dataSetRow["impRate"]</expression>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="name">impPercent</property>
                    <text-property name="displayName">impPercent</text-property>
                    <expression name="expression" type="javascript">dataSetRow["impPercent"]</expression>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="name">clkFwd</property>
                    <text-property name="displayName">clkFwd</text-property>
                    <expression name="expression" type="javascript">dataSetRow["clkFwd"]</expression>
                    <property name="dataType">float</property>
                </structure>
                <structure>
                    <property name="name">clkRateLimit</property>
                    <text-property name="displayName">clkRateLimit</text-property>
                    <expression name="expression" type="javascript">dataSetRow["clkRateLimit"]</expression>
                    <property name="dataType">float</property>
                </structure>
                <structure>
                    <property name="name">clkRate</property>
                    <text-property name="displayName">clkRate</text-property>
                    <expression name="expression" type="javascript">dataSetRow["clkRate"]</expression>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="name">actImp</property>
                    <text-property name="displayName">actImp</text-property>
                    <expression name="expression" type="javascript">dataSetRow["actImp"]</expression>
                    <property name="dataType">float</property>
                </structure>
                <structure>
                    <property name="name">impBlock</property>
                    <text-property name="displayName">impBlock</text-property>
                    <expression name="expression" type="javascript">dataSetRow["impBlock"]</expression>
                    <property name="dataType">float</property>
                </structure>
                <structure>
                    <property name="name">actClk</property>
                    <text-property name="displayName">actClk</text-property>
                    <expression name="expression" type="javascript">dataSetRow["actClk"]</expression>
                    <property name="dataType">float</property>
                </structure>
                <structure>
                    <property name="name">clkBlock</property>
                    <text-property name="displayName">clkBlock</text-property>
                    <expression name="expression" type="javascript">dataSetRow["clkBlock"]</expression>
                    <property name="dataType">float</property>
                </structure>
                <structure>
                    <property name="name">impFwdSum</property>
                    <property name="dataType">float</property>
                    <simple-property-list name="aggregateOn">
                        <value>NewTableGroup1</value>
                    </simple-property-list>
                    <property name="aggregateFunction">SUM</property>
                    <list-property name="arguments">
                        <structure>
                            <property name="name">Expression</property>
                            <expression name="value" type="javascript">row["impFwd"]</expression>
                        </structure>
                    </list-property>
                    <property name="allowExport">true</property>
                </structure>
                <structure>
                    <property name="name">clkFwdSum</property>
                    <property name="dataType">float</property>
                    <simple-property-list name="aggregateOn">
                        <value>NewTableGroup1</value>
                    </simple-property-list>
                    <property name="aggregateFunction">SUM</property>
                    <list-property name="arguments">
                        <structure>
                            <property name="name">Expression</property>
                            <expression name="value" type="javascript">row["clkFwd"]</expression>
                        </structure>
                    </list-property>
                    <property name="allowExport">true</property>
                </structure>
                <structure>
                    <property name="name">actImpSum</property>
                    <property name="dataType">float</property>
                    <simple-property-list name="aggregateOn">
                        <value>NewTableGroup1</value>
                    </simple-property-list>
                    <property name="aggregateFunction">SUM</property>
                    <list-property name="arguments">
                        <structure>
                            <property name="name">Expression</property>
                            <expression name="value" type="javascript">row["actImp"]</expression>
                        </structure>
                    </list-property>
                    <property name="allowExport">true</property>
                </structure>
                <structure>
                    <property name="name">impBlockSum</property>
                    <property name="dataType">float</property>
                    <simple-property-list name="aggregateOn">
                        <value>NewTableGroup1</value>
                    </simple-property-list>
                    <property name="aggregateFunction">SUM</property>
                    <list-property name="arguments">
                        <structure>
                            <property name="name">Expression</property>
                            <expression name="value" type="javascript">row["impBlock"]</expression>
                        </structure>
                    </list-property>
                    <property name="allowExport">true</property>
                </structure>
                <structure>
                    <property name="name">impChoke</property>
                    <text-property name="displayName">impChoke</text-property>
                    <expression name="expression" type="javascript">dataSetRow["impChoke"]</expression>
                    <property name="dataType">float</property>
                </structure>
                <structure>
                    <property name="name">clkChoke</property>
                    <text-property name="displayName">clkChoke</text-property>
                    <expression name="expression" type="javascript">dataSetRow["clkChoke"]</expression>
                    <property name="dataType">float</property>
                </structure>
                <structure>
                    <property name="name">impChokeSum</property>
                    <property name="dataType">float</property>
                    <simple-property-list name="aggregateOn">
                        <value>NewTableGroup1</value>
                    </simple-property-list>
                    <property name="aggregateFunction">SUM</property>
                    <list-property name="arguments">
                        <structure>
                            <property name="name">Expression</property>
                            <expression name="value" type="javascript">row["impChoke"]</expression>
                        </structure>
                    </list-property>
                    <property name="allowExport">true</property>
                </structure>
                <structure>
                    <property name="name">actClkSum</property>
                    <property name="dataType">float</property>
                    <simple-property-list name="aggregateOn">
                        <value>NewTableGroup1</value>
                    </simple-property-list>
                    <property name="aggregateFunction">SUM</property>
                    <list-property name="arguments">
                        <structure>
                            <property name="name">Expression</property>
                            <expression name="value" type="javascript">row["actClk"]</expression>
                        </structure>
                    </list-property>
                    <property name="allowExport">true</property>
                </structure>
                <structure>
                    <property name="name">clkBlockSum</property>
                    <property name="dataType">float</property>
                    <simple-property-list name="aggregateOn">
                        <value>NewTableGroup1</value>
                    </simple-property-list>
                    <property name="aggregateFunction">SUM</property>
                    <list-property name="arguments">
                        <structure>
                            <property name="name">Expression</property>
                            <expression name="value" type="javascript">row["clkBlock"]</expression>
                        </structure>
                    </list-property>
                    <property name="allowExport">true</property>
                </structure>
                <structure>
                    <property name="name">clkChokeSum</property>
                    <property name="dataType">float</property>
                    <simple-property-list name="aggregateOn">
                        <value>NewTableGroup1</value>
                    </simple-property-list>
                    <property name="aggregateFunction">SUM</property>
                    <list-property name="arguments">
                        <structure>
                            <property name="name">Expression</property>
                            <expression name="value" type="javascript">row["clkChoke"]</expression>
                        </structure>
                    </list-property>
                    <property name="allowExport">true</property>
                </structure>
                <structure>
                    <property name="name">area_type</property>
                    <text-property name="displayName">area_type</text-property>
                    <expression name="expression" type="javascript">dataSetRow["area_type"]</expression>
                    <property name="dataType">string</property>
                    <property name="allowExport">true</property>
                </structure>
                <structure>
                    <property name="name">Column Binding</property>
                    <expression name="expression" type="javascript">dataSetRow["areaId"]</expression>
                    <property name="dataType">integer</property>
                    <property name="allowExport">true</property>
                </structure>
                <structure>
                    <property name="name">impChokeArea</property>
                    <text-property name="displayName">impChokeArea</text-property>
                    <expression name="expression" type="javascript">dataSetRow["impChokeArea"]</expression>
                    <property name="dataType">float</property>
                    <property name="allowExport">true</property>
                </structure>
                <structure>
                    <property name="name">Aggregation</property>
                    <text-property name="displayName">impChokeAreaSum</text-property>
                    <property name="dataType">float</property>
                    <simple-property-list name="aggregateOn">
                        <value>NewTableGroup1</value>
                    </simple-property-list>
                    <property name="aggregateFunction">SUM</property>
                    <list-property name="arguments">
                        <structure>
                            <property name="name">Expression</property>
                            <expression name="value" type="javascript">row["impChokeArea"]</expression>
                        </structure>
                    </list-property>
                    <property name="allowExport">true</property>
                </structure>
                <structure>
                    <property name="name">clkChokeArea</property>
                    <text-property name="displayName">clkChokeArea</text-property>
                    <expression name="expression" type="javascript">dataSetRow["clkChokeArea"]</expression>
                    <property name="dataType">string</property>
                    <property name="allowExport">true</property>
                </structure>
                <structure>
                    <property name="name">clkChokeAreaSum</property>
                    <text-property name="displayName">clkChokeAreaSum</text-property>
                    <property name="dataType">float</property>
                    <simple-property-list name="aggregateOn">
                        <value>NewTableGroup1</value>
                    </simple-property-list>
                    <property name="aggregateFunction">SUM</property>
                    <list-property name="arguments">
                        <structure>
                            <property name="name">Expression</property>
                            <expression name="value" type="javascript">row["clkChokeArea"]</expression>
                        </structure>
                    </list-property>
                    <property name="allowExport">true</property>
                </structure>
                <structure>
                    <property name="name">planImp</property>
                    <text-property name="displayName">planImp</text-property>
                    <expression name="expression" type="javascript">dataSetRow["planImp"]</expression>
                    <property name="dataType">float</property>
                </structure>
                <structure>
                    <property name="name">planImpSum</property>
                    <property name="dataType">float</property>
                    <simple-property-list name="aggregateOn">
                        <value>NewTableGroup1</value>
                    </simple-property-list>
                    <property name="aggregateFunction">SUM</property>
                    <list-property name="arguments">
                        <structure>
                            <property name="name">Expression</property>
                            <expression name="value" type="javascript">row["planImp"]</expression>
                        </structure>
                    </list-property>
                    <property name="allowExport">true</property>
                </structure>
                <structure>
                    <property name="name">planClk</property>
                    <text-property name="displayName">planClk</text-property>
                    <expression name="expression" type="javascript">dataSetRow["planClk"]</expression>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="name">planClkSum</property>
                    <property name="dataType">float</property>
                    <simple-property-list name="aggregateOn">
                        <value>NewTableGroup1</value>
                    </simple-property-list>
                    <property name="aggregateFunction">MAX</property>
                    <list-property name="arguments">
                        <structure>
                            <property name="name">Expression</property>
                            <expression name="value" type="javascript">row["planClk"]</expression>
                        </structure>
                    </list-property>
                    <property name="allowExport">true</property>
                </structure>
                <structure>
                    <property name="name">planImpDate</property>
                    <property name="dataType">float</property>
                    <simple-property-list name="aggregateOn">
                        <value>NewTableGroup1</value>
                    </simple-property-list>
                    <property name="aggregateFunction">MAX</property>
                    <list-property name="arguments">
                        <structure>
                            <property name="name">Expression</property>
                            <expression name="value" type="javascript">row["planImp"]</expression>
                        </structure>
                    </list-property>
                    <property name="allowExport">true</property>
                </structure>
                <structure>
                    <property name="name">imp_limit_total</property>
                    <text-property name="displayName">imp_limit_total</text-property>
                    <property name="dataType">float</property>
                    <simple-property-list name="aggregateOn">
                        <value>NewTableGroup1</value>
                    </simple-property-list>
                    <property name="aggregateFunction">LAST</property>
                    <list-property name="arguments">
                        <structure>
                            <property name="name">Expression</property>
                            <expression name="value" type="javascript">row["impLimit"]</expression>
                        </structure>
                    </list-property>
                    <property name="allowExport">true</property>
                </structure>
                <structure>
                    <property name="name">planImpDateFoot</property>
                    <text-property name="displayName">planImpDateFooter</text-property>
                    <property name="dataType">float</property>
                    <property name="aggregateFunction">SUM</property>
                    <list-property name="arguments">
                        <structure>
                            <property name="name">Expression</property>
                            <expression name="value" type="javascript">row["planImpDate"]</expression>
                        </structure>
                    </list-property>
                    <property name="allowExport">true</property>
                </structure>
                <structure>
                    <property name="name">impLimitTotalFoot</property>
                    <text-property name="displayName">impLimitTotalFoot</text-property>
                    <property name="dataType">float</property>
                    <property name="aggregateFunction">SUM</property>
                    <list-property name="arguments">
                        <structure>
                            <property name="name">Expression</property>
                            <expression name="value" type="javascript">row["imp_limit_total"]</expression>
                        </structure>
                    </list-property>
                    <property name="allowExport">true</property>
                </structure>
                <structure>
                    <property name="name">impFwdSumFoot</property>
                    <text-property name="displayName">impFwdSumFoot</text-property>
                    <property name="dataType">float</property>
                    <property name="aggregateFunction">SUM</property>
                    <list-property name="arguments">
                        <structure>
                            <property name="name">Expression</property>
                            <expression name="value" type="javascript">row["impFwdSum"]</expression>
                        </structure>
                    </list-property>
                    <property name="allowExport">true</property>
                </structure>
                <structure>
                    <property name="name">planClkFooter</property>
                    <text-property name="displayName">planClkFooter</text-property>
                    <property name="dataType">float</property>
                    <property name="aggregateFunction">SUM</property>
                    <list-property name="arguments">
                        <structure>
                            <property name="name">Expression</property>
                            <expression name="value" type="javascript">row["planClkSum"]</expression>
                        </structure>
                    </list-property>
                    <property name="allowExport">true</property>
                </structure>
                <structure>
                    <property name="name">planImpDateFooter</property>
                    <text-property name="displayName">planImpDateFooter</text-property>
                    <property name="dataType">float</property>
                    <property name="aggregateFunction">SUM</property>
                    <list-property name="arguments">
                        <structure>
                            <property name="name">Expression</property>
                            <expression name="value" type="javascript">row["planImpDate"]</expression>
                        </structure>
                    </list-property>
                    <property name="allowExport">true</property>
                </structure>
                <structure>
                    <property name="name">impLimitTotalFooter</property>
                    <text-property name="displayName">impLimitTotalFooter</text-property>
                    <property name="dataType">float</property>
                    <property name="aggregateFunction">SUM</property>
                    <list-property name="arguments">
                        <structure>
                            <property name="name">Expression</property>
                            <expression name="value" type="javascript">row["imp_limit_total"]</expression>
                        </structure>
                    </list-property>
                    <property name="allowExport">true</property>
                </structure>
                <structure>
                    <property name="name">impFwdSumFooter</property>
                    <text-property name="displayName">impFwdSumFooter</text-property>
                    <property name="dataType">float</property>
                    <property name="aggregateFunction">SUM</property>
                    <list-property name="arguments">
                        <structure>
                            <property name="name">Expression</property>
                            <expression name="value" type="javascript">row["impFwdSum"]</expression>
                        </structure>
                    </list-property>
                    <property name="allowExport">true</property>
                </structure>
                <structure>
                    <property name="name">clkFwdSumFooter</property>
                    <text-property name="displayName">clkFwdSumFooter</text-property>
                    <property name="dataType">float</property>
                    <property name="aggregateFunction">SUM</property>
                    <list-property name="arguments">
                        <structure>
                            <property name="name">Expression</property>
                            <expression name="value" type="javascript">row["clkFwdSum"]</expression>
                        </structure>
                    </list-property>
                    <property name="allowExport">true</property>
                </structure>
                <structure>
                    <property name="name">impChokeAreaFooter</property>
                    <text-property name="displayName">impChokeAreaFooter</text-property>
                    <property name="dataType">float</property>
                    <property name="aggregateFunction">SUM</property>
                    <list-property name="arguments">
                        <structure>
                            <property name="name">Expression</property>
                            <expression name="value" type="javascript">row["impChokeArea"]</expression>
                        </structure>
                    </list-property>
                    <property name="allowExport">true</property>
                </structure>
                <structure>
                    <property name="name">clkChokeAreaFooter</property>
                    <text-property name="displayName">clkChokeAreaFooter</text-property>
                    <property name="dataType">float</property>
                    <property name="aggregateFunction">SUM</property>
                    <list-property name="arguments">
                        <structure>
                            <property name="name">Expression</property>
                            <expression name="value" type="javascript">row["clkChokeArea"]</expression>
                        </structure>
                    </list-property>
                    <property name="allowExport">true</property>
                </structure>
                <structure>
                    <property name="name">clkRateLimitFooter</property>
                    <text-property name="displayName">clkRateLimitFooter</text-property>
                    <property name="dataType">float</property>
                    <property name="aggregateFunction">SUM</property>
                    <list-property name="arguments">
                        <structure>
                            <property name="name">Expression</property>
                            <expression name="value" type="javascript">row["clkRateLimit"]</expression>
                        </structure>
                    </list-property>
                    <property name="allowExport">true</property>
                </structure>
                <structure>
                    <property name="name">actImpFooter</property>
                    <text-property name="displayName">actImpFooter</text-property>
                    <property name="dataType">float</property>
                    <property name="aggregateFunction">SUM</property>
                    <list-property name="arguments">
                        <structure>
                            <property name="name">Expression</property>
                            <expression name="value" type="javascript">row["actImpSum"]</expression>
                        </structure>
                    </list-property>
                    <property name="allowExport">true</property>
                </structure>
                <structure>
                    <property name="name">actClkFooter</property>
                    <text-property name="displayName">actClkFooter</text-property>
                    <property name="dataType">float</property>
                    <property name="aggregateFunction">SUM</property>
                    <list-property name="arguments">
                        <structure>
                            <property name="name">Expression</property>
                            <expression name="value" type="javascript">row["actClkSum"]</expression>
                        </structure>
                    </list-property>
                    <property name="allowExport">true</property>
                </structure>
                <structure>
                    <property name="name">impBlockFooter</property>
                    <text-property name="displayName">impBlockFooter</text-property>
                    <property name="dataType">float</property>
                    <property name="aggregateFunction">SUM</property>
                    <list-property name="arguments">
                        <structure>
                            <property name="name">Expression</property>
                            <expression name="value" type="javascript">row["impBlockSum"]</expression>
                        </structure>
                    </list-property>
                    <property name="allowExport">true</property>
                </structure>
                <structure>
                    <property name="name">impChokeFooter</property>
                    <text-property name="displayName">impChokeFooter</text-property>
                    <property name="dataType">float</property>
                    <property name="aggregateFunction">SUM</property>
                    <list-property name="arguments">
                        <structure>
                            <property name="name">Expression</property>
                            <expression name="value" type="javascript">row["impChokeSum"]</expression>
                        </structure>
                    </list-property>
                    <property name="allowExport">true</property>
                </structure>
                <structure>
                    <property name="name">clkBlockFooter</property>
                    <text-property name="displayName">clkBlockFooter</text-property>
                    <property name="dataType">float</property>
                    <property name="aggregateFunction">SUM</property>
                    <list-property name="arguments">
                        <structure>
                            <property name="name">Expression</property>
                            <expression name="value" type="javascript">row["clkBlockSum"]</expression>
                        </structure>
                    </list-property>
                    <property name="allowExport">true</property>
                </structure>
                <structure>
                    <property name="name">clkChokeFooter</property>
                    <text-property name="displayName">clkChokeFooter</text-property>
                    <property name="dataType">float</property>
                    <property name="aggregateFunction">SUM</property>
                    <list-property name="arguments">
                        <structure>
                            <property name="name">Expression</property>
                            <expression name="value" type="javascript">row["clkChoke"]</expression>
                        </structure>
                    </list-property>
                    <property name="allowExport">true</property>
                </structure>
            </list-property>
            <property name="pageBreakInterval">100</property>
            <property name="sortByGroups">false</property>
            <column id="344">
                <list-property name="visibility">
                    <structure>
                        <property name="format">all</property>
                        <expression name="valueExpr" type="javascript">true</expression>
                    </structure>
                </list-property>
            </column>
            <column id="345">
                <list-property name="visibility">
                    <structure>
                        <property name="format">all</property>
                        <expression name="valueExpr" type="javascript">true</expression>
                    </structure>
                </list-property>
            </column>
            <column id="346"/>
            <column id="347"/>
            <column id="348">
                <list-property name="visibility">
                    <structure>
                        <property name="format">all</property>
                        <expression name="valueExpr" type="javascript">true</expression>
                    </structure>
                </list-property>
            </column>
            <column id="349"/>
            <column id="525"/>
            <column id="350"/>
            <column id="351"/>
            <column id="530"/>
            <column id="353"/>
            <column id="550"/>
            <column id="354"/>
            <column id="501">
                <property name="repeat">1</property>
            </column>
            <column id="540">
                <property name="repeat">1</property>
            </column>
            <column id="509"/>
            <column id="355"/>
            <column id="356"/>
            <column id="357"/>
            <column id="360">
                <property name="repeat">1</property>
            </column>
            <column id="358"/>
            <column id="359"/>
            <column id="361"/>
            <column id="362"/>
            <column id="518"/>
            <header>
                <row id="246">
                    <property name="backgroundColor">#F5FAFA</property>
                    <property name="fontFamily">"微软雅黑"</property>
                    <property name="fontSize">10pt</property>
                    <cell id="247">
                        <label id="248">
                            <text-property name="text">groupMark</text-property>
                        </label>
                    </cell>
                    <cell id="249">
                        <label id="250">
                            <text-property name="text">monId</text-property>
                        </label>
                    </cell>
                    <cell id="251">
                        <label id="252">
                            <property name="fontFamily">"微软雅黑"</property>
                            <text-property name="text">地域</text-property>
                            <list-property name="action">
                                <structure>
                                    <property name="linkType">none</property>
                                </structure>
                            </list-property>
                        </label>
                    </cell>
                    <cell id="253">
                        <label id="254">
                            <property name="fontFamily">"微软雅黑"</property>
                            <text-property name="text">日期</text-property>
                        </label>
                    </cell>
                    <cell id="255">
                        <label id="256">
                            <text-property name="text">areaId</text-property>
                        </label>
                    </cell>
                    <cell id="257">
                        <label id="258">
                            <property name="fontFamily">"微软雅黑"</property>
                            <text-property name="text">path</text-property>
                        </label>
                    </cell>
                    <cell id="522">
                        <text id="526">
                            <property name="fontFamily">"微软雅黑"</property>
                            <property name="contentType">html</property>
                            <text-property name="content"><![CDATA[计划投放量]]></text-property>
                        </text>
                    </cell>
                    <cell id="259">
                        <label name="impLimit" id="260">
                            <property name="fontFamily">"微软雅黑"</property>
                            <text-property name="text">设定投放量</text-property>
                        </label>
                    </cell>
                    <cell id="261">
                        <label name="impFwd" id="262">
                            <property name="fontFamily">"微软雅黑"</property>
                            <text-property name="text">执行投放量</text-property>
                        </label>
                    </cell>
                    <cell id="527">
                        <text id="531">
                            <property name="fontFamily">"微软雅黑"</property>
                            <property name="contentType">auto</property>
                            <text-property name="content"><![CDATA[执行/计划]]></text-property>
                        </text>
                    </cell>
                    <cell id="265">
                        <label name="impRate" id="266">
                            <text-property name="text">执行/设定</text-property>
                        </label>
                    </cell>
                    <cell id="547">
                        <text id="551">
                            <property name="fontFamily">"微软雅黑"</property>
                            <property name="contentType">html</property>
                            <text-property name="content"><![CDATA[计划点击量]]></text-property>
                        </text>
                    </cell>
                    <cell id="267">
                        <label name="clkFwd" id="268">
                            <property name="fontFamily">"微软雅黑"</property>
                            <text-property name="text">执行点击量</text-property>
                        </label>
                    </cell>
                    <cell id="497">
                        <label name="impChokeArea" id="502">
                            <property name="fontFamily">"微软雅黑"</property>
                            <text-property name="text">地域播放量</text-property>
                        </label>
                    </cell>
                    <cell id="541">
                        <label name="impPercent1" id="542">
                            <property name="fontFamily">"微软雅黑"</property>
                            <text-property name="text">播放比</text-property>
                        </label>
                    </cell>
                    <cell id="505">
                        <label name="clkChokeArea" id="510">
                            <property name="fontFamily">"微软雅黑"</property>
                            <text-property name="text">地域点击量</text-property>
                        </label>
                    </cell>
                    <cell id="269">
                        <label name="clkRateLimit" id="270">
                            <property name="fontFamily">"微软雅黑"</property>
                            <text-property name="text">日点击指标</text-property>
                        </label>
                    </cell>
                    <cell id="271">
                        <label name="clkRate" id="272">
                            <property name="fontFamily">"微软雅黑"</property>
                            <text-property name="text">点击率</text-property>
                        </label>
                    </cell>
                    <cell id="273">
                        <label name="actImp" id="274">
                            <property name="fontFamily">"微软雅黑"</property>
                            <text-property name="text">播放请求量</text-property>
                        </label>
                    </cell>
                    <cell id="279">
                        <label name="actClk" id="280">
                            <property name="fontFamily">"微软雅黑"</property>
                            <text-property name="text">点击请求量</text-property>
                        </label>
                    </cell>
                    <cell id="275">
                        <label name="impBlock" id="276">
                            <property name="fontFamily">"微软雅黑"</property>
                            <text-property name="text">无效播放量</text-property>
                        </label>
                    </cell>
                    <cell id="277">
                        <label name="impChoke" id="278">
                            <property name="fontFamily">"微软雅黑"</property>
                            <text-property name="text">异常播放量</text-property>
                        </label>
                    </cell>
                    <cell id="281">
                        <label name="clkBlock" id="282">
                            <property name="fontFamily">"微软雅黑"</property>
                            <text-property name="text">无效点击量</text-property>
                        </label>
                    </cell>
                    <cell id="283">
                        <label name="clkChoke" id="284">
                            <property name="fontFamily">"微软雅黑"</property>
                            <text-property name="text">异常点击量</text-property>
                        </label>
                    </cell>
                    <cell id="514">
                        <text-data name="data_operation" id="519">
                            <method name="onRender"><![CDATA[this.text = "<a href='javascript:void(0);' onclick=\"new function(e){oEvent=e||event;var x =oEvent.clientX;var y =oEvent.clientY;parent.showColsSelectInfo('mc',x,y);}\" > <img style='float:right' src='/images/report/selectcols.gif'/></a>";]]></method>
                            <property name="allowExport">false</property>
                            <expression name="valueExpr">1</expression>
                            <property name="contentType">html</property>
                        </text-data>
                    </cell>
                </row>
            </header>
            <group id="406">
                <property name="groupName">NewTableGroup1</property>
                <expression name="keyExpr" type="javascript">row["groupMark"]</expression>
                <structure name="toc">
                    <expression name="expressionValue" type="javascript">row["groupMark"]</expression>
                </structure>
                <property name="hideDetail">false</property>
                <header>
                    <row id="407">
                        <method name="onCreate"><![CDATA[rowCount++;
if(rowCount > 1 &amp;&amp; rowCount % recordNum == 0){
  pageBreak = 1;
  //this.style.pageBreakBefore = "always";
} 

if(path != "") {
   isVisiualColorCountSum++;
   if(isVisiualColorCountSum % 2 == 0 ) {
     this.getStyle().backgroundColor="#F5FAFA";
   } else {
     this.getStyle().backgroundColor="#FFFFFF";
   }
}
]]></method>
                        <method name="onRender"><![CDATA[path = reportContext.getParameterValue("path");

if(path != null &amp;&amp; path != "") {
  if(path != "*") {
     this.getStyle().display= "none";
  }
}

var format = reportContext.getHttpServletRequest().getParameter("__format");
if(format == "xls") {
	this.getStyle().backgroundColor = "#FFFFFF";
}
		]]></method>
                        <property name="backgroundColor">#F5FAFA</property>
                        <property name="fontFamily">"微软雅黑"</property>
                        <property name="fontSize">9pt</property>
                        <property name="fontWeight">normal</property>
                        <property name="fontStyle">normal</property>
                        <property name="textAlign">center</property>
                        <cell id="408">
                            <data id="447">
                                <property name="resultSetColumn">groupMark</property>
                            </data>
                        </cell>
                        <cell id="409">
                            <data id="448">
                                <property name="resultSetColumn">monId</property>
                            </data>
                        </cell>
                        <cell id="410">
                            <text-data id="490">
                                <property name="fontFamily">"微软雅黑"</property>
                                <expression name="valueExpr">if(row["area_type"] == 'group') {&#13;
    "&lt;a target='_blank' href='"+params["ctx"].value + "/mc/imp-report-day-areagroup?id="+params["monId"].value +"&amp;areaGroupName=" +row["areaName"] +"&amp;monDate="+row["monDate"]+"&amp;areaId="+row["areaId"]+"'>"+getAreaName(row["areaId"])+"&lt;/a>";&#13;
} else { getAreaName(row["areaId"]);}</expression>
                                <property name="contentType">html</property>
                            </text-data>
                        </cell>
                        <cell id="411">
                            <data id="457">
                                <method name="onRender"><![CDATA[
]]></method>
                                <property name="resultSetColumn">monDate</property>
                                <list-property name="action">
                                    <structure>
                                        <property name="linkType">hyperlink</property>
                                        <expression name="uri" type="javascript">params["ctx"].value + "/mc/imp-report-hour?monId=" + row["monId"] + "&amp;areaName=" + row["areaName"] + "&amp;areaId=" +row["areaId"] + "&amp;monDate=" + row["monDate"] + &#13;
"&amp;path=&amp;impLimit=" + row["impLimit"] + "&amp;clkRateLimit=" + row["clkRateLimit"] + "&amp;isVisualArea=" +params["isVisualArea"].value+"&amp;areaGroupName=" +params["areaGroupName"].value+"&amp;areaType=" + row["area_type"];</expression>
                                        <property name="targetWindow">_blank</property>
                                    </structure>
                                </list-property>
                            </data>
                        </cell>
                        <cell id="412">
                            <data id="458">
                                <property name="resultSetColumn">areaId</property>
                            </data>
                        </cell>
                        <cell id="413">
                            <text id="475">
                                <property name="contentType">auto</property>
                                <text-property name="content"><![CDATA[*]]></text-property>
                            </text>
                        </cell>
                        <cell id="523">
                            <data id="567">
                                <property name="fontFamily">"微软雅黑"</property>
                                <method name="onRender"><![CDATA[if(this.getValue() == 0 || this.getValue() == "" || this.getValue() == null) 
  this.setDisplayValue("-");]]></method>
                                <property name="resultSetColumn">planImpDate</property>
                            </data>
                        </cell>
                        <cell id="414">
                            <data id="570">
                                <property name="fontFamily">"微软雅黑"</property>
                                <method name="onRender"><![CDATA[if(this.getValue() == 0 || this.getValue() == "" || this.getValue() == null) 
  this.setDisplayValue("-");]]></method>
                                <property name="resultSetColumn">imp_limit_total</property>
                            </data>
                        </cell>
                        <cell id="415">
                            <data name="data_sum_impFwd" id="459">
                                <property name="fontFamily">"微软雅黑"</property>
                                <property name="resultSetColumn">impFwdSum</property>
                                <list-property name="action">
                                    <structure>
                                        <property name="linkType">hyperlink</property>
                                        <expression name="uri" type="javascript">mcImpUrl("imp_fwd",1,row["impFwdSum"])</expression>
                                        <property name="targetWindow">_blank</property>
                                    </structure>
                                </list-property>
                            </data>
                        </cell>
                        <cell id="528">
                            <text-data id="558">
                                <expression name="valueExpr">getPercent(row["impFwdSum"],row["planImpDate"])</expression>
                                <property name="contentType">html</property>
                            </text-data>
                        </cell>
                        <cell id="417">
                            <data name="data_sum_impRate" id="460">
                                <method name="onRender"><![CDATA[rowt = this.getRowData();
                                    impFwd = rowt.getExpressionValue( "row[impFwdSum]");
                                    impLimit = rowt.getExpressionValue( "row[imp_limit_total]");
                                    rate = getPercent(impFwd, impLimit);
                                    if(impLimit == -1) {
                                       this.setDisplayValue("-");
                                    } else {
                                       this.setDisplayValue(rate);
                                    }
                                ]]></method>
                                <property name="resultSetColumn">impRate</property>
                            </data>
                        </cell>
                        <cell id="548">
                            <data id="555">
                                <method name="onRender"><![CDATA[if(this.getValue() == 0 || this.getValue() == "" || this.getValue() == null) 
  this.setDisplayValue("-");]]></method>
                                <property name="resultSetColumn">planClkSum</property>
                            </data>
                        </cell>
                        <cell id="418">
                            <data name="data_sum_clkFwd" id="461">
                                <property name="resultSetColumn">clkFwdSum</property>
                                <list-property name="action">
                                    <structure>
                                        <property name="linkType">hyperlink</property>
                                        <expression name="uri" type="javascript">mcImpUrl("clk_fwd",1,row["clkFwdSum"])</expression>
                                        <property name="targetWindow">_blank</property>
                                    </structure>
                                </list-property>
                            </data>
                        </cell>
                        <cell id="498">
                            <data name="data_sum_impChokeArea" id="504">
                                <property name="resultSetColumn">Aggregation</property>
                            </data>
                        </cell>
                        <cell id="543">
                            <text name="data_sum_impPercent1" id="544">
                                <property name="contentType">auto</property>
                                <text-property name="content"><![CDATA[-]]></text-property>
                            </text>
                        </cell>
                        <cell id="506">
                            <data name="data_sum_clkChokeArea" id="512">
                                <property name="resultSetColumn">clkChokeAreaSum</property>
                            </data>
                        </cell>
                        <cell id="419">
                            <text name="data_sum_clkRateLimit" id="463">
                                <property name="contentType">auto</property>
                                <text-property name="content"><![CDATA[-]]></text-property>
                            </text>
                        </cell>
                        <cell id="420">
                            <text-data name="data_sum_clkRate" id="479">
                                <expression name="valueExpr">getPercent(row["clkFwdSum"],row["impFwdSum"])</expression>
                                <property name="contentType">html</property>
                            </text-data>
                        </cell>
                        <cell id="421">
                            <data name="data_sum_actImp" id="465">
                                <property name="resultSetColumn">actImpSum</property>
                                <list-property name="action">
                                    <structure>
                                        <property name="linkType">hyperlink</property>
                                        <expression name="uri" type="javascript">mcImpUrl("act_imp",1,row["actImpSum"])</expression>
                                        <property name="targetWindow">_blank</property>
                                    </structure>
                                </list-property>
                            </data>
                        </cell>
                        <cell id="424">
                            <data name="data_sum_actClk" id="471">
                                <property name="resultSetColumn">actClkSum</property>
                                <list-property name="action">
                                    <structure>
                                        <property name="linkType">hyperlink</property>
                                        <expression name="uri" type="javascript">mcImpUrl("act_clk",1,row["actClkSum"])</expression>
                                        <property name="targetWindow">_blank</property>
                                    </structure>
                                </list-property>
                            </data>
                        </cell>
                        <cell id="422">
                            <data name="data_sum_impBlock" id="466">
                                <property name="resultSetColumn">impBlockSum</property>
                                <list-property name="action">
                                    <structure>
                                        <property name="linkType">hyperlink</property>
                                        <expression name="uri" type="javascript">mcImpUrl("imp_block",1,row["impBlockSum"]);</expression>
                                        <property name="targetWindow">_blank</property>
                                    </structure>
                                </list-property>
                            </data>
                        </cell>
                        <cell id="423">
                            <data name="data_sum_impChoke" id="470">
                                <property name="resultSetColumn">impChokeSum</property>
                                <list-property name="action">
                                    <structure>
                                        <property name="linkType">hyperlink</property>
                                        <expression name="uri" type="javascript">mcImpUrl("imp_choke",1,row["impChokeSum"])</expression>
                                        <property name="targetWindow">_blank</property>
                                    </structure>
                                </list-property>
                            </data>
                        </cell>
                        <cell id="425">
                            <data name="data_sum_clkBlock" id="472">
                                <property name="resultSetColumn">clkBlockSum</property>
                                <list-property name="action">
                                    <structure>
                                        <property name="linkType">hyperlink</property>
                                        <expression name="uri" type="javascript">mcImpUrl("clk_block",1,row["clkBlockSum"])</expression>
                                        <property name="targetWindow">_blank</property>
                                    </structure>
                                </list-property>
                            </data>
                        </cell>
                        <cell id="426">
                            <data name="data_sum_clkChoke" id="473">
                                <property name="resultSetColumn">clkChokeSum</property>
                                <list-property name="action">
                                    <structure>
                                        <property name="linkType">hyperlink</property>
                                        <expression name="uri" type="javascript">mcImpUrl("clk_choke",1,row["clkChokeSum"])</expression>
                                        <property name="targetWindow">_blank</property>
                                    </structure>
                                </list-property>
                            </data>
                        </cell>
                        <cell id="515">
                            <text name="sift_total" id="571">
                                <property name="contentType">html</property>
                                <text-property name="content"><![CDATA[&amp;nbsp;]]></text-property>
                            </text>
                        </cell>
                    </row>
                </header>
            </group>
            <detail>
                <row id="285">
                    <method name="onCreate"><![CDATA[path = reportContext.getParameterValue("path");

if(path == "" || path == null || path == "null") {
   rowCount++;
} else if( path != "*") {
   rowCount++;
}


if(rowCount > 1 &amp;&amp; rowCount % recordNum == 0 || pageBreak == 1){
  pageBreak = 0;
  this.style.pageBreakAfter = "always";
} 

if(path != "") {
   isVisiualColorCount++;
   if(isVisiualColorCount % 2 == 0 ) {
     this.getStyle().backgroundColor="#F5FAFA";
   } else {
     this.getStyle().backgroundColor="#FFFFFF";
   }
}]]></method>
                    <method name="onRender"><![CDATA[path = reportContext.getParameterValue("path");
if(path != null &amp;&amp; path != "") {
  if(path.equals("*")) {
     this.getStyle().display= "none";
  }
}]]></method>
                    <property name="fontFamily">"微软雅黑"</property>
                    <property name="fontSize">9pt</property>
                    <property name="textAlign">center</property>
                    <cell id="286">
                        <data id="287">
                            <property name="resultSetColumn">groupMark</property>
                        </data>
                    </cell>
                    <cell id="288">
                        <data id="289">
                            <property name="resultSetColumn">monId</property>
                        </data>
                    </cell>
                    <cell id="290">
                        <text-data id="489">
                            <property name="fontFamily">"微软雅黑"</property>
                            <expression name="valueExpr">if(row["area_type"] == 'group') {&#13;
    "&lt;a target='_blank' href='"+params["ctx"].value + "/mc/imp-report-day-areagroup?id="+params["monId"].value+"&amp;areaGroupName=" +row["areaName"]  +"&amp;monDate="+row["monDate"]+"&amp;path=" + row["path"]+"&amp;areaId="+row["areaId"]+"'>"+getAreaName(row["areaId"])+"&lt;/a>";&#13;
} else { getAreaName(row["areaId"]);}</expression>
                            <property name="contentType">html</property>
                        </text-data>
                    </cell>
                    <cell id="292">
                        <data id="293">
                            <property name="resultSetColumn">monDate</property>
                            <list-property name="action">
                                <structure>
                                    <property name="linkType">hyperlink</property>
                                    <expression name="uri" type="javascript">params["ctx"].value +"/mc/imp-report-hour?monId=" + row["monId"] + "&amp;areaName=" + row["areaName"] + "&amp;areaId=" +row["areaId"] + "&amp;monDate=" + row["monDate"] + "&amp;path="+row["path"]+"&amp;impLimit=" + row["impLimit"] + "&amp;clkRateLimit=" + row["clkRateLimit"] +"&amp;isVisualArea=" + params["isVisualArea"].value+"&amp;areaGroupName=" +params["areaGroupName"].value+"&amp;areaType=" + row["area_type"];</expression>
                                    <property name="targetWindow">_blank</property>
                                </structure>
                            </list-property>
                        </data>
                    </cell>
                    <cell id="294">
                        <data id="295">
                            <structure name="numberFormat">
                                <property name="category">Unformatted</property>
                            </structure>
                            <property name="resultSetColumn">areaId</property>
                        </data>
                    </cell>
                    <cell id="296">
                        <data id="297">
                            <method name="onRender"><![CDATA[path = this.getValue();
if (path == 0) {
	path = '-';
}
this.setDisplayValue(path);]]></method>
                            <property name="resultSetColumn">path</property>
                        </data>
                    </cell>
                    <cell id="524">
                        <data id="559">
                            <method name="onRender"><![CDATA[this.setDisplayValue("-");]]></method>
                            <property name="resultSetColumn">planImp</property>
                        </data>
                    </cell>
                    <cell id="298">
                        <text name="data_impLimit" id="476">
                            <property name="contentType">auto</property>
                            <text-property name="content"><![CDATA[-]]></text-property>
                        </text>
                    </cell>
                    <cell id="300">
                        <data name="data_impFwd" id="301">
                            <property name="resultSetColumn">impFwd</property>
                            <list-property name="action">
                                <structure>
                                    <property name="linkType">hyperlink</property>
                                    <expression name="uri" type="javascript">mcImpUrl("imp_fwd",0,row["impFwd"]);</expression>
                                    <property name="targetWindow">_blank</property>
                                </structure>
                            </list-property>
                        </data>
                    </cell>
                    <cell id="529">
                        <text-data id="557">
                            <expression name="valueExpr">getPercent(row["impFwd"],row["planImp"])</expression>
                            <property name="contentType">html</property>
                        </text-data>
                    </cell>
                    <cell id="304">
                        <text name="data_impRate" id="477">
                            <property name="contentType">auto</property>
                            <text-property name="content"><![CDATA[-]]></text-property>
                        </text>
                    </cell>
                    <cell id="549">
                        <data id="554">
                            <method name="onRender"><![CDATA[this.setDisplayValue("-");]]></method>
                            <property name="resultSetColumn">planClk</property>
                        </data>
                    </cell>
                    <cell id="306">
                        <data name="data_clkFwd" id="307">
                            <property name="resultSetColumn">clkFwd</property>
                            <list-property name="action">
                                <structure>
                                    <property name="linkType">hyperlink</property>
                                    <expression name="uri" type="javascript">mcImpUrl("clk_fwd",0,row["clkFwd"])</expression>
                                    <property name="targetWindow">_blank</property>
                                </structure>
                            </list-property>
                        </data>
                    </cell>
                    <cell id="499">
                        <data name="data_impChokeArea" id="503">
                            <property name="resultSetColumn">impChokeArea</property>
                        </data>
                    </cell>
                    <cell id="545">
                        <text-data name="data_impPercent1" id="546">
                            <expression name="valueExpr">openSubReport(row["monId"],row["monDate"], row["areaId"], row["path"], row["impPercent"],'-1');</expression>
                            <property name="contentType">html</property>
                        </text-data>
                    </cell>
                    <cell id="507">
                        <data name="data_clkChokeArea" id="511">
                            <property name="resultSetColumn">clkChokeArea</property>
                        </data>
                    </cell>
                    <cell id="308">
                        <data name="data_clkRateLimit" id="309">
                            <method name="onRender"><![CDATA[rowt = this.getRowData();
                            clkVal = this.getValue();
                            rate = getPercent(clkVal, 100);
                            this.setDisplayValue(rate);
                            ]]></method>
                            <property name="resultSetColumn">clkRateLimit</property>
                        </data>
                    </cell>
                    <cell id="310">
                        <text-data name="data_clkRate" id="478">
                            <expression name="valueExpr">getPercent(row["clkFwd"],row["impFwd"])</expression>
                            <property name="contentType">html</property>
                        </text-data>
                    </cell>
                    <cell id="312">
                        <data name="data_actImp" id="313">
                            <property name="resultSetColumn">actImp</property>
                            <list-property name="action">
                                <structure>
                                    <property name="linkType">hyperlink</property>
                                    <expression name="uri" type="javascript">mcImpUrl("act_imp",0,row["actImp"])</expression>
                                    <property name="targetWindow">_blank</property>
                                </structure>
                            </list-property>
                        </data>
                    </cell>
                    <cell id="318">
                        <data name="data_actClk" id="319">
                            <property name="resultSetColumn">actClk</property>
                            <list-property name="action">
                                <structure>
                                    <property name="linkType">hyperlink</property>
                                    <expression name="uri" type="javascript">mcImpUrl("act_clk",0,row["actClk"])</expression>
                                    <property name="targetWindow">_blank</property>
                                </structure>
                            </list-property>
                        </data>
                    </cell>
                    <cell id="314">
                        <data name="data_impBlock" id="315">
                            <property name="resultSetColumn">impBlock</property>
                            <list-property name="action">
                                <structure>
                                    <property name="linkType">hyperlink</property>
                                    <expression name="uri" type="javascript">mcImpUrl("imp_block",0,row["impBlock"])</expression>
                                    <property name="targetWindow">_blank</property>
                                </structure>
                            </list-property>
                        </data>
                    </cell>
                    <cell id="316">
                        <data name="data_impChoke" id="481">
                            <property name="resultSetColumn">impChoke</property>
                            <list-property name="action">
                                <structure>
                                    <property name="linkType">hyperlink</property>
                                    <expression name="uri" type="javascript">mcImpUrl("imp_choke",0,row["impChoke"])</expression>
                                    <property name="targetWindow">_blank</property>
                                </structure>
                            </list-property>
                        </data>
                    </cell>
                    <cell id="320">
                        <data name="data_clkBlock" id="321">
                            <property name="resultSetColumn">clkBlock</property>
                            <list-property name="action">
                                <structure>
                                    <property name="linkType">hyperlink</property>
                                    <expression name="uri" type="javascript">mcImpUrl("clk_block",0,row["clkBlock"])</expression>
                                    <property name="targetWindow">_blank</property>
                                </structure>
                            </list-property>
                        </data>
                    </cell>
                    <cell id="322">
                        <data name="data_clkChoke" id="469">
                            <property name="resultSetColumn">clkChoke</property>
                            <list-property name="action">
                                <structure>
                                    <property name="linkType">hyperlink</property>
                                    <expression name="uri" type="javascript">mcImpUrl("clk_choke",0,row["clkChoke"])</expression>
                                    <property name="targetWindow">_blank</property>
                                </structure>
                            </list-property>
                        </data>
                    </cell>
                    <cell id="516">
                        <text name="sift_sub" id="572">
                            <property name="contentType">html</property>
                            <text-property name="content"><![CDATA[&amp;nbsp;]]></text-property>
                        </text>
                    </cell>
                </row>
            </detail>
            <footer>
                <row id="573">
                    <cell id="574"/>
                    <cell id="575"/>
                    <cell id="576">
                        <text id="619">
                            <property name="fontWeight">bold</property>
                            <property name="contentType">html</property>
                            <text-property name="content"><![CDATA[总计]]></text-property>
                        </text>
                    </cell>
                    <cell id="577"/>
                    <cell id="578"/>
                    <cell id="579"/>
                    <cell id="580">
                        <data id="604">
                            <method name="onRender"><![CDATA[if(this.getValue() == 0 || this.getValue() == "" || this.getValue() == null || this.getValue() < 0) 
  this.setDisplayValue("-");]]></method>
                            <property name="resultSetColumn">planImpDateFooter</property>
                        </data>
                    </cell>
                    <cell id="581">
                        <data id="605">
                            <method name="onRender"><![CDATA[path = reportContext.getParameterValue("path");
if(path != "" &amp;&amp; path != null &amp;&amp; path.length() > 0 &amp;&amp; path != "*") {
   this.setDisplayValue("-");
} else {
   if(this.getValue() == 0 || this.getValue() == "" || this.getValue() == null || this.getValue() < 0) 
      this.setDisplayValue("-");
}


]]></method>
                            <property name="resultSetColumn">impLimitTotalFooter</property>
                        </data>
                    </cell>
                    <cell id="582">
                        <data id="606">
                            <property name="resultSetColumn">impFwdSumFooter</property>
                        </data>
                    </cell>
                    <cell id="583">
                        <text-data id="621">
                            <expression name="valueExpr">getPercent(row["impFwdSumFooter"],row["planImpDateFoot"])</expression>
                            <property name="contentType">html</property>
                        </text-data>
                    </cell>
                    <cell id="584">
                        <text-data id="622">
                            <expression name="valueExpr">getPercent(row["impFwdSumFooter"],row["impLimitTotalFooter"])</expression>
                            <property name="contentType">html</property>
                        </text-data>
                    </cell>
                    <cell id="585">
                        <data id="603">
                            <method name="onRender"><![CDATA[if(this.getValue() == 0 || this.getValue() == "" || this.getValue() == null || this.getValue() < 0) 
  this.setDisplayValue("-");]]></method>
                            <property name="resultSetColumn">planClkFooter</property>
                        </data>
                    </cell>
                    <cell id="586">
                        <data id="607">
                            <property name="resultSetColumn">clkFwdSumFooter</property>
                        </data>
                    </cell>
                    <cell id="587">
                        <data id="609">
                            <property name="resultSetColumn">impChokeAreaFooter</property>
                        </data>
                    </cell>
                    <cell id="588">
                        <text id="620">
                            <property name="contentType">html</property>
                            <text-property name="content"><![CDATA[-]]></text-property>
                        </text>
                    </cell>
                    <cell id="589">
                        <data id="610">
                            <property name="resultSetColumn">clkChokeAreaFooter</property>
                        </data>
                    </cell>
                    <cell id="590">
                        <text id="625">
                            <property name="contentType">html</property>
                            <text-property name="content"><![CDATA[-]]></text-property>
                        </text>
                    </cell>
                    <cell id="591">
                        <text-data id="623">
                            <expression name="valueExpr">getPercent(row["clkFwdSumFooter"],row["impFwdSumFooter"])</expression>
                            <property name="contentType">html</property>
                        </text-data>
                    </cell>
                    <cell id="592">
                        <data id="612">
                            <property name="resultSetColumn">actImpFooter</property>
                        </data>
                    </cell>
                    <cell id="593">
                        <data id="613">
                            <property name="resultSetColumn">actClkFooter</property>
                        </data>
                    </cell>
                    <cell id="594">
                        <data id="614">
                            <property name="resultSetColumn">impBlockFooter</property>
                        </data>
                    </cell>
                    <cell id="595">
                        <data id="615">
                            <property name="resultSetColumn">impChokeFooter</property>
                        </data>
                    </cell>
                    <cell id="596">
                        <data id="616">
                            <property name="resultSetColumn">clkBlockFooter</property>
                        </data>
                    </cell>
                    <cell id="597">
                        <data id="617">
                            <property name="resultSetColumn">clkChokeFooter</property>
                        </data>
                    </cell>
                    <cell id="598">
                        <text name="sift_footer" id="624">
                            <property name="contentType">html</property>
                            <text-property name="content"><![CDATA[&amp;nbsp;]]></text-property>
                        </text>
                    </cell>
                </row>
            </footer>
        </table>
    </body>
</report>
